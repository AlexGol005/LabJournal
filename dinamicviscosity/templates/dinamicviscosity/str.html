{% extends 'main/superbase.html' %}

{% block title %}
{{ NAME }}
{% endblock %}

{#кнопки слева странички#}
{% block content %}
<div class="row">
<div class="col-md-2">

    <div class="noprint">

    <a href="/attestationJ/{{ URL }}/registration/" class="btn btn-warning mt-3 mr-5">&nbsp&nbspвнести&nbsp&nbsp&nbsp ещё </a>
    <a href='/attestationJ/{{ URL }}/' class="btn btn-warning mt-3">В  журнал</a>
    <a href='/attestationJ/{{ URL }}/attestation/' class="btn btn-warning mt-3">Все записи</a>
        </div>
</div>

{#уникальная таблица#}
{#полустандартный верх таблицы#}
<div class="col-md-4 mt-1" >
    <table class="table table-bordered background-color">
	<tbody>
        <tr>
			<th colspan="9"><div style="text-align: center;">Атт.-ВЖ-(МИ № 02-2018)-дин. вязкость-{{ note.date|date:"Y"}}
                &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                 &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspСтр.&nbsp&nbsp&nbsp&nbsp </div></th>
		</tr>
		<tr>
			<th colspan="9"><div style="text-align: center;">Опр. плотности <b>  {{ note.equipment }}</b> и расчёт динамической вязкости по {{ note.ndocument }} </div></th>
		</tr>
		<tr>
			<th colspan="3"><div style="text-align: center;">Дата </div></th>
			<th colspan="1"><div style="text-align: center;">Наименование</div></th>
			<th colspan="1"><div style="text-align: center;">Номер партии</div></th>
			<th colspan="2"><div style="text-align: center;">

              &nbsp&nbspТ°C&nbsp&nbsp</div></th>
			<th colspan="4"><div style="text-align: center;">Сод.&nbspнефть или октол</div></th>
		</tr>
		<tr>
			<td colspan="3"><div style="text-align: center;">{{ note.date|date:"d.m.Y" }}</div></td>
			<td colspan="1"><div style="text-align: center;">{{ note.name}}</div></td>
			<td colspan="1"><div style="text-align: center;">{{ note.lot}}</div></td>
			<td colspan="2"><div style="text-align: center;">{{ note.temperature|striptags}}</div></td>
			<td colspan="4"><div style="text-align: center;">{{ note.constit}}</div></td>
		</tr>
{# конец полустандартного верха таблицы#}
{# совсем уникальная часть таблицы#}
		<tr>
			<th colspan="9"><div style="text-align: center;">Измерение плотности</div></th>
		</tr>

		<tr>
			<th colspan="2"><div style="text-align: center;">V(пикн.), мл</div></th>
            <td colspan="2"><div style="text-align: center;">{{ note.piknometer_volume|default_if_none:" "|striptags }}</div></td>
			<th colspan="2"><div style="text-align: center;">Измерение&nbsp1</div></th>
			<th colspan="3"><div style="text-align: center;">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspИзмерение&nbsp2&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</div></th>
		</tr>

		<tr>
			<th colspan="4"><div style="text-align: center;">m(пикн.), г</div></th>
			<td colspan="2"><div style="text-align: center;">{{ note.piknometer_mass1|default_if_none:" "|striptags }}</div></td>
            <td colspan="3"><div style="text-align: center;">{{ note.piknometer_mass2|default_if_none:" "|striptags }}</div></td>
		</tr>
		<tr>
			<th colspan="4"><div style="text-align: center;">m(СО + пикн.), г</div></th>
			<td colspan="2"><div style="text-align: center;">{{ note.piknometer_plus_SM_mass1|default_if_none:" "|striptags }}</div></td>
			<td colspan="3"><div style="text-align: center;">{{ note.piknometer_plus_SM_mass2|default_if_none:" "|striptags }}</div></td>

		</tr>
		<tr>
			<th colspan="4"><div style="text-align: center;"> m(СО), г</div></th>
			<td colspan="2"><div style="text-align: center;">{{ note.SM_mass1|default_if_none:" "|striptags }}</div></td>
			<td colspan="3"><div style="text-align: center;">{{ note.SM_mass2|default_if_none:" "|striptags }}</div></td>
		</tr>
		<tr>
			<th colspan="4"><div style="text-align: center;">ρ<sub>1</sub>, г/мл</div></th>
			<td colspan="5"><div style="text-align: center;">{{ note.density1|default_if_none:" "|striptags }}</div></td>
		</tr>
        <tr>
			<th colspan="4"><div style="text-align: center;">ρ<sub>2</sub>, г/м</div></th>
			<td colspan="5"><div style="text-align: center;">{{ note.density2|default_if_none:" "|striptags }}</div></td>
		</tr>
        <tr>
			<th colspan="4"><div style="text-align: center;">плотность  измерил</div></th>
			<td colspan="5"><div style="text-align: center;">{{ note.performerdensity|default_if_none:" "|striptags }}</div></td>
		</tr>
		<tr>
			<th colspan="9"><div style="text-align: center;">Обработка результатов</div></th>
		</tr>
		<tr>
			<th colspan="3"><div style="text-align: center;">Сред. плотн., ρ, г/мл</div></th>
			<th colspan="4"><div style="text-align: center;">Оценка приемлемости измерений &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                Δ = (|ρ<sub>1</sub> - ρ<sub>2</sub>|/ρ<sub>сред</sub>) * 100 %</div></th>
			<th colspan="2"><div style="text-align: center;">Критерий приемл. измерений, r  </div></th>
		</tr>
		<tr>
			<td colspan="3"><div style="text-align: center;">{{ note.density_avg|default_if_none:" "|striptags }}</div></td>
			<td colspan="4"><div style="text-align: center;">{{ note.accMeasurement|default_if_none:" "|striptags }}</div></td>
			<td colspan="2"><div style="text-align: center;">{{ note.kriteriy|default_if_none:" "|striptags}}</div></td>
		</tr>
{# блок оценки результатов #}
		<tr>
			<tr>
			<td colspan="9">
                {% if note.resultMeas == 'неудовлетворительно' %}
                <div class="TransactionAmount Badresult">
                {% else %}
                <div class="TransactionAmount Goodresult">
                {% endif %}
                 Результат измерений: <b>{{ note.resultMeas }} </b> {{ note.cause }}


                &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                </div>
            </td>
		    </tr>
        <tr>
{# конец блока оценки результатов #}
			<th colspan="9"><div style="text-align: center;">Расчёт динамической вязкости</div></th>
		</tr>
		<tr>
			<th colspan="4"><div style="text-align: center;">Вязкость кинематическая при температуре измерений, ν,  мм<sup>2</sup>/с&nbsp&nbsp</div></th>
			<th colspan="5"><div style="text-align: center;">Вязкость динамическая, ν<sub>дин</sub> = ν * ρ<sub>сред</sub> , Па*с </div></th>
		</tr>
		<tr>
			<td colspan="4">
                 {% if note.kinematicviscosity|striptags %}
                  {{ note.kinematicviscosity|default_if_none:" "|striptags }}
                {% endif %}
            </td>
			<td colspan="5"><div style="text-align: center;">{{ note.dinamicviscosity_not_rouned|default_if_none:" "|striptags }}</div></td>
		</tr>
        <tr>
			<th colspan="9"><div style="text-align: center;">Фиксация результатов</div></th>
		</tr>
		<tr>
			<th colspan="1"><div style="text-align: center;">АЗ, Дин. вязк., Па * с</div></th>
			<th colspan="3"><div style="text-align: center;">
                Абс.&nbspпогр.&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                (ν<sub>дин</sub> <sub>сред</sub> * 0,3)/ 100</div></th>
			<th colspan="1"><div style="text-align: center;">Пред. зн. плот., ρ<sub>пред</sub>, г/мл</div></th>
			<th colspan="4">Разница с ρ<sub>пред  </sub>
                &nbsp&nbsp&nbsp&nbsp&nbsp
                Δρ<sub>пред</sub> = (|ρ<sub>изм</sub> - ρ<sub>пред</sub>|/ρ<sub>сред</sub>) * 100 %</th></th>
		</tr>
		<tr>
			<td colspan="1"><div style="text-align: center;">{{ note.certifiedValue|default_if_none:" "|striptags }}</div></td>
			<td colspan="3"><div style="text-align: center;">{{ note.abserror|default_if_none:" "|striptags }}</div></td>
			<td colspan="1"><div style="text-align: center;">{{ note.olddensity|default_if_none:" "|striptags }}</div></td>
            <td colspan="4"><div style="text-align: center;">{{ note.deltaolddensity|default_if_none:" "|striptags }}</div></td>
		</tr>
        <tr>
        <td colspan="9">

                <div class="TransactionAmount Badresult">
                  <b>{{ note.resultWarning|default_if_none:" " }}</b>
                    <b>{{ note.resultWarningkinematic|default_if_none:" " }}</b>
                </div>
            </td>
		</tr>
{#конец уникальной части таблицы #}

{# полустандартный низ таблицы с формой фиксации АЗ и кнопкой "комментарии" #}
        <tr>
			<th colspan="3">Исполнитель </th>
            <th colspan="1"><div style="text-align: center;">отпр.</div></th>
            <th colspan="1"><div style="text-align: center;">внесено</div></th>
            <th colspan="3">ОТК</th>
            <th colspan="1">комметарии</th>

		</tr>
		<tr>
			<th colspan="3">{{ note.performer }} </th>
            <td colspan="1"><div style="text-align: center;"></div></td>
            <td colspan="1">
                {% if note.resultMeas == 'удовлетворительно' and not note.fixation or note.resultMeas == 'плотность измерена ранее'  and not note.fixation %}
                <form method="post" >
                {% csrf_token %}
                {{ form.as_p }}
                <button class="btn btn-outline-warning" type="submit" name="btnform2">Подтвердить</button>
                </form>
                {% elif  note.resultMeas == 'удовлетворительно' and note.fixation or note.resultMeas == 'плотность измерена ранее'  and note.fixation %}
                   <a href="/CertifiedValueJ/dinamicviscosityvalues/" target="blank"> АЗ записано в ЖАЗ сайта </a>
                {% else %}
                нет АЗ
                {% endif %}
            </td>
            <td colspan="3"><div style="text-align: center;">
            </div></td>
            <th colspan="1">
                {% if not counter %}
                <a href="/attestationJ/{{ URL }}/attestation/{{ note.id }}/comments/"  class="btn btn-outline-warning mt-3">комментировать</a>
                {% elif counter %}
                <a href="/attestationJ/{{ URL }}/attestation/{{ note.id }}/comments/"  class="btn btn-outline-warning mt-3">смотреть комментарии</a></th>
                {% endif %}
            </tr>
{# конец низа #}
	</tbody>
</table>
</div>
{#конец  таблицы#}
</div>
    &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
    &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
    &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
    &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
    &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
{#кнопка печать #}
   {#кнопка печать #}
    <div class="noprint">
    <a href="javascript:(print());" class="btn btn-warning mt-1">Распечатать</a>
    <a href="{% url 'export_dinamicviscosity_xls' note.pk %}"  class="btn btn-warning ml-5 mt-1">Сохранить в EXEL</a>
        {% if note.room %}
    <a href="{% url 'dinamicviscosityprotocolbutton' note.pk %}"  class="btn btn-warning ml-5 mt-1">
        Сформировать протокол испытаний</a>
        {% else %}
    <a href="{% url 'dinamicviscosityprotocolhead' note.pk %}"  class="btn btn-warning ml-5 mt-1">
        Сформировать протокол испытаний</a>
        {% endif %}
    <br>
    <br>
    </div>
{% endblock %}
